<!DOCTYPE html>
<html lang="uz">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Nft Battle | TestğŸ’ </title>
<style>
body {
  margin:0;
  font-family:'Poppins',sans-serif;
  background:radial-gradient(circle at top,#0b0b0f,#000);
  color:white;
  overflow-x:hidden;
}
header {
  text-align:center;
  padding:15px;
  font-size:26px;
  font-weight:700;
  background:linear-gradient(90deg,#00ffcc,#0099ff);
  -webkit-background-clip:text;
  -webkit-text-fill-color:transparent;
}
.balance {text-align:center;margin-top:10px;font-size:20px;}
.menu {display:flex;justify-content:space-around;flex-wrap:wrap;margin:20px;}
.btn {background:linear-gradient(145deg,#1a1a1f,#2a2a30);border:2px solid #00ffc8;border-radius:12px;padding:15px 25px;color:white;font-weight:bold;cursor:pointer;transition:0.2s;margin:10px;}
.btn:hover {background:#00ffc8;color:#000;transform:scale(1.05);}
.section {display:none;text-align:center;animation:fadeIn 0.5s;}
.active {display:block;}
.keys-grid {display:grid;grid-template-columns:repeat(3,1fr);gap:15px;padding:10px;}
.key-card {background:#121217;border:2px solid #00ffcc;border-radius:15px;padding:15px;}
.key-img {width:90px;border-radius:10px;}
.inventory {display:grid;grid-template-columns:repeat(auto-fit,minmax(130px,1fr));gap:15px;padding:10px;}
.nft-item {background:#18181f;border:2px solid #00ffc8;border-radius:15px;padding:10px;}
.nft-item img {width:100%;border-radius:10px;}
.inline-btns {display:flex;justify-content:space-around;margin-top:5px;}
.small-btn {background:#00ffc8;border:none;border-radius:8px;padding:6px 10px;font-size:12px;cursor:pointer;}
#message {text-align:center;font-size:16px;margin-top:10px;color:#00ffcc;}
.selectNFT {margin:15px auto;width:220px;padding:8px;border-radius:8px;}
.status-icons {position:absolute;top:0;right:10px;font-size:24px;}
@keyframes fadeIn {from{opacity:0;}to{opacity:1;}}
</style>
</head>
<body>

<header>ğŸ¸ Nft Battle | TestğŸ’ </header>
<div class="balance">â­ Balans: <span id="balance">0</span></div>
<div class="status-icons" id="statusIcons"></div>

<div class="menu">
  <button class="btn" onclick="showSection('keys')">ğŸ§° Keyslar</button>
  <button class="btn" onclick="showSection('rocket')">ğŸš€ Raketa</button>
  <button class="btn" onclick="showSection('shop')">ğŸ›’ Tariflar</button>
  <button class="btn" onclick="showSection('inventory')">ğŸ“¦ Inventar</button>
  <button class="btn" onclick="showPromocode()">ğŸ Promokod</button>
</div>

<div id="message"></div>

<div id="keys" class="section active">
  <div id="keysGrid" class="keys-grid"></div>
</div>

<div id="rocket" class="section">
  <h2>ğŸš€ Raketa sinovi</h2>
  <p>Inventardan NFT tanlang va â€œBosishâ€ tugmasini bosing:</p>
  <select id="nftSelect" class="selectNFT"></select><br>
  <button class="btn" onclick="launchRocket()">ğŸ”¥ Bosish</button>
</div>

<div id="shop" class="section">
  <h2>ğŸ›’ Tariflar</h2>
  <div id="vipAdminShop"></div>
</div>

<div id="inventory" class="section">
  <h2>ğŸ“¦ Inventar</h2>
  <div class="inventory" id="inventoryList"></div>
</div>

<script>
// --- Data ---
let balance=parseInt(localStorage.getItem("balance"))||700000;
let inventory=JSON.parse(localStorage.getItem("inventory"))||[];
let vipActive=JSON.parse(localStorage.getItem("vipActive"))||false;
let adminActive=JSON.parse(localStorage.getItem("adminActive"))||false;
let promocodesUsed=JSON.parse(localStorage.getItem("promocodesUsed"))||[];
let ayubxonLimit=parseInt(localStorage.getItem("ayubxonLimit"))||2;

// --- Elements ---
const balanceEl=document.getElementById("balance");
const msg=document.getElementById("message");
const statusIcons=document.getElementById("statusIcons");
balanceEl.textContent=balance.toLocaleString();

// --- NFT Images ---
const pepeNFTs=["https://i.imgur.com/RXQ0vvW.png"];
const signetNFTs=["https://i.imgur.com/obv6hIj.png"];
const durovNFTs=["https://i.imgur.com/k4fQNOt.png"];
const ayubNFT=["https://i.imgur.com/M5lnD3A.png"];

// --- Keys ---
let keysList=[
  // Yangi Keyslar
  {name:"Ayubxon's BagğŸ’",img:pepeNFTs,price:500,sell:250,limited:false,vip:false},
  {name:"Ayubxon's CapğŸ§¢",img:pepeNFTs,price:5000000,sell:2500000,limited:false,vip:false},
  {name:"KitobğŸ“–",img:pepeNFTs,price:2000,sell:1000,limited:false,vip:false},
  {name:"ChemodanğŸ§³",img:pepeNFTs,price:5000,sell:2500,limited:false,vip:false},
  {name:"RuchkağŸ–‹ï¸",img:pepeNFTs,price:2500,sell:1250,limited:false,vip:false},
  {name:"SurfingğŸ¤¿",img:pepeNFTs,price:2500,sell:1250,limited:false,vip:false},
  {name:"OchkiğŸ•¶ï¸",img:pepeNFTs,price:30000,sell:18000,limited:false,vip:false},
  {name:"RedoğŸ§¸",img:pepeNFTs,price:30000,sell:15000,limited:false,vip:false},

  // Eski Giftslar
  {name:"Plush Pepe",img:pepeNFTs,price:50999,sell:90000,limited:false,vip:false},
  {name:"Durov's Cap",img:durovNFTs,price:150000,sell:75000,limited:false,vip:false},
  {name:"Signet Ring",img:signetNFTs,price:300000,sell:150000,limited:true,vip:false,count:50},
  {name:"Ayubxon Haykali ğŸ—½",img:ayubNFT,price:300999999,sell:700999999,limited:true,vip:false,count:ayubxonLimit}
];

// --- Save ---
function saveData(){
  localStorage.setItem("balance",balance);
  localStorage.setItem("inventory",JSON.stringify(inventory));
  localStorage.setItem("vipActive",vipActive);
  localStorage.setItem("adminActive",adminActive);
  localStorage.setItem("promocodesUsed",JSON.stringify(promocodesUsed));
  localStorage.setItem("ayubxonLimit",keysList.find(k=>k.name.includes("Ayubxon Haykali"))?.count || 0);
}

// --- Message ---
function showMsg(t){msg.textContent=t;setTimeout(()=>msg.textContent="",2500);}

// --- Sections ---
function showSection(id){
  document.querySelectorAll('.section').forEach(s=>s.classList.remove('active'));
  document.getElementById(id).classList.add('active');
  if(id==='inventory')renderInventory();
  if(id==='rocket')updateNFTSelect();
  if(id==='keys')renderKeys();
  if(id==='shop')renderShop();
}

// --- Render keys ---
function renderKeys(){
  const grid=document.getElementById("keysGrid");
  grid.innerHTML="";
  keysList.forEach((k,i)=>{
    const vipStyle=k.vip&&!vipActive?"opacity:0.5;":"";
    const limitedText=k.limited?`<p>â³ Qolgan: ${k.count}</p>`:"";
    grid.innerHTML+=`
      <div class="key-card" style="${vipStyle}">
        <img src="${k.img[0]}" class="key-img">
        <h3>${k.name}</h3>
        <p>ğŸª™ Narxi: <b>${k.price.toLocaleString()}â­</b></p>
        ${limitedText}
        <button class="btn" onclick="buyKey(${i})">ğŸ Sotib olish</button>
      </div>`;
  });
  updateStatusIcons();
}

// --- Buy key ---
function buyKey(i){
  let k=keysList[i];
  if(k.limited && k.count<=0){showMsg("âŒ Limit tugadi!");return;}
  if(k.vip&&!vipActive){showMsg("âŒ VIP kerak!");return;}
  if(balance<k.price){showMsg("âŒ Yetarli balans yoâ€˜q!");return;}
  balance-=k.price;
  balanceEl.textContent=balance.toLocaleString();
  const nftId=Math.floor(Math.random()*9999);
  inventory.push({img:k.img[0],id:nftId,name:k.name});
  if(k.limited)k.count--;
  saveData();renderKeys();renderInventory();
  showMsg(`âœ… ${k.name} #${nftId} ochildi!`);
}

// --- Inventory ---
function renderInventory(){
  const list=document.getElementById("inventoryList");
  list.innerHTML="";
  inventory.forEach((n,i)=>{
    const sellPrice=keysList.find(k=>k.name===n.name)?.sell||0;
    list.innerHTML+=`
      <div class="nft-item">
        <img src="${n.img}">
        <p>${n.name} #${n.id}</p>
        <div class="inline-btns">
          <button class="small-btn" onclick="sellNFT(${i})">ğŸ’° ${sellPrice.toLocaleString()}â­</button>
        </div>
      </div>`;
  });
  saveData();
}

// --- Sell NFT ---
function sellNFT(i){
  const nft=inventory[i];
  const k=keysList.find(x=>x.name===nft.name);
  balance+=k.sell;
  inventory.splice(i,1);
  balanceEl.textContent=balance.toLocaleString();
  showMsg(`âœ… ${nft.name} sotildi!`);
  saveData();renderInventory();
}

// --- Rocket ---
function updateNFTSelect(){
  const sel=document.getElementById("nftSelect");
  sel.innerHTML="";
  if(inventory.length===0){sel.innerHTML="<option>Inventar boâ€˜sh</option>";return;}
  inventory.forEach((n,i)=>{
    const opt=document.createElement("option");
    opt.value=i;
    opt.textContent=`${n.name} #${n.id}`;
    sel.appendChild(opt);
  });
}

function launchRocket(){
  if(inventory.length===0){showMsg("âŒ NFT yoâ€˜q!");return;}
  const sel=document.getElementById("nftSelect");
  const index=parseInt(sel.value);
  if(isNaN(index)){showMsg("NFT tanlang!");return;}
  const win=Math.random()<0.5;
  if(win){balance+=3000000;showMsg("ğŸš€ Yutdingiz! +3 000 000â­");}
  else{inventory.splice(index,1);showMsg("ğŸ’¥ Raketa portladi! NFT yoâ€˜qoldi!");}
  balanceEl.textContent=balance.toLocaleString();
  saveData();renderInventory();updateNFTSelect();
}

// --- VIP / ADMIN ---
function buyVIP(){
  if(vipActive){showMsg("âœ… Siz allaqachon VIP!");return;}
  if(balance<5000000){showMsg("âŒ Yetarli balans yoâ€˜q!");return;}
  balance-=5000000;vipActive=true;
  balanceEl.textContent=balance.toLocaleString();
  saveData();updateStatusIcons();renderShop();
  showMsg("ğŸ‘‘ VIP aktiv boâ€˜ldi!");
}

function toggleAdmin(){
  if(adminActive){showMsg("Admin oâ€˜chiq");adminActive=false;saveData();renderShop();updateStatusIcons();return;}
  let code=prompt("Admin kodini kiriting:");
  if(code==="ayubxon2929"){adminActive=true;saveData();showMsg("ğŸ‘¨ğŸ»â€ğŸ’» Admin aktiv!");updateStatusIcons();renderShop();}
  else showMsg("âŒ Notoâ€˜gâ€˜ri kod!");
}

function updateStatusIcons(){
  statusIcons.innerHTML="";
  if(vipActive)statusIcons.innerHTML+="ğŸ‘‘ ";
  if(adminActive)statusIcons.innerHTML+="ğŸ‘¨ğŸ»â€ğŸ’»";
}

// --- Tariflar ---
function renderShop(){
  const shop=document.getElementById("vipAdminShop");
  shop.innerHTML="";
  shop.innerHTML+=`<button class="btn" onclick="buyVIP()">ğŸ‘‘ VIP Tarif - 5 000 000â­</button>`;
  shop.innerHTML+=`<button class="btn" onclick="toggleAdmin()">ğŸ‘¨ğŸ»â€ğŸ’» Admin Tarif</button>`;
  if(adminActive){
    shop.innerHTML+=`<button class="btn" onclick="openAdminPanel()">ğŸ› ï¸ Boshqaruv</button>`;
  }
}

// --- Admin panel ---
function openAdminPanel(){
  const choose=prompt("1ï¸âƒ£ Balans qoâ€˜shish\n2ï¸âƒ£ Yangi keys qoâ€˜shish\nTanlang:");
  if(choose==="1"){
    let add=parseInt(prompt("Qancha qoâ€˜shmoqchisiz?"));
    if(!add)return;balance+=add;balanceEl.textContent=balance.toLocaleString();saveData();showMsg("âœ… Balans qoâ€˜shildi!");
  } else if(choose==="2"){
    let name=prompt("Case nomi:");
    let price=parseInt(prompt("Narxi:"));
    let sell=parseInt(prompt("Sotish narxi:"));
    if(!name||!price||!sell){showMsg("âŒ Ma'lumot xato!");return;}
    keysList.push({name:name,img:pepeNFTs,price:price,sell:sell,limited:false,vip:false});
    showMsg(`âœ… ${name} qoâ€˜shildi!`);
    renderKeys();saveData();
  } else showMsg("Bekor qilindi.");
}

// --- Promokod ---
function showPromocode(){
  let code=prompt("Promokodni kiriting:");
  if(!code)return;
  if(promocodesUsed.includes(code)){showMsg("âŒ Bu kod ishlatilgan!");return;}
  if(code==="nftbattle1"){balance+=500000;showMsg("âœ… Promokod ishladi +500 000â­");}
  else if(code==="obnova"){balance+=3000000;showMsg("âœ… Promokod ishladi +3 000 000â­");}
  else if(code==="giftupdate"){balance+=10000000;showMsg("âœ… Yangi gift bonus +10 000 000â­");}
  else{showMsg("âŒ Notoâ€˜gi kod!");return;}
  promocodesUsed.push(code);
  balanceEl.textContent=balance.toLocaleString();
  saveData();
}

// --- Init ---
renderKeys();renderInventory();updateStatusIcons();renderShop();
</script>
</body>
</html>
